<div class="paymentDiv" ng-controller="PaymentController as payment">
    <div class="animated fadeIn">
        <div class="navBar col-md-12 col-xs-12 col-sm-12 col-lg-12">
            <div ng-include="'app/views/partials/menuStep.html'"></div>
        </div>
        <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12 contentDiv">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-xs-12 col-md-8 col-sm-12 ">
                        <div class="whiteDiv col-lg-12 p-0">
                            <div class="whiteHeader p-15" ng-if="!loggedIn||userCards.length==0">
                                <h4>Payment Details</h4>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="form-group">
                                            <label>Credit/Debit Card Number</label>
                                            <input masked="" data-inputmask="'mask': '9999 9999 9999 9999'"
                                                   onkeypress="return isNumberKey(event)" class="form-control" ng-model="payment.addCard.number">
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="form-group">
                                            <label>Month</label>
                                            <select ng-model="payment.addCard.month" class="form-control">
                                                <option value="">Month</option>
                                                <option ng-value="month" ng-repeat="month in months">{{month.month}} ({{month.month_name}})</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="form-group">
                                            <label>Year</label>
                                            <select ng-model="payment.addCard.year" class="form-control" >
                                                <option value="">Year</option>
                                                <option ng-value="year" ng-repeat="year in newYears">{{year}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="form-group">
                                            <label>CVV</label>
                                            <input type="password" class="form-control" ng-model="payment.addCard.cvv" maxlength="4" minlength="3">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="whiteHeader p-15" ng-if="loggedIn&&userCards.length>0">
                                <h4 class="m-t-0 col-lg-6 col-xs-12">Your Saved Cards</h4>
                                <a class="text-right col-lg-6 col-xs-12" style="color: #ee7670" ng-click="payment.ngDialogPop('addCardModal','bigPop')">Add new card</a>
                                <div class="clearfix"></div>
                                <div class="row m-t-20">
                                    <div class="col-lg-6 col-xs-12" ng-repeat="data in userCards">
                                        <div class="savedAddressDiv ">
                                            <div class="radio">
                                                <label class="savAddSubDiv">
                                                    <input style="margin-top: 1px;" type="radio" ng-model="payment.savedCard"
                                                           name="savedCard" value="{{$index}}" ng-click="payment.cardSelect($index)"/>
                                                    <div class="w-100">
                                                        <h4>XXXX-XXXX-XXXX-{{data.last_4}}<i class="fa pull-right"
                                                            ng-class="{'fa-cc-visa':data.card_brand=='Visa','fa-cc-amex':data.card_brand=='American Express',
                                                            'fa-cc-mastercard':data.card_brand=='MasterCard','fa-cc-discover':data.card_brand=='Discover',
                                                            'fa-cc-jcb':data.card_brand=='JCB','fa-cc-diners-club':data.card_brand=='Diners Club',
                                                            'fa-cc-credit-card':data.card_brand=='Unknown'}">

                                                        </i></h4>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="whiteHeader p-15" ng-if="!payment.coupon">
                                <h4>Have a Promo Code?</h4>
                                <div class="row">
                                    <div class="col-lg-12 col-xs-12">
                                        <div class="form-group">
                                            <input class="form-control" ng-model="payment.promo">
                                        </div>
                                        <button ng-click="payment.checkPromo()" class="btn btnDefault col-lg-4 col-md-4 col-sm-4 col-xs-6 m-t-15">Apply Promo</button>
                                    </div>
                                </div>
                            </div>
                            <div class="whiteHeader p-15" ng-if="payment.coupon">
                                <h4>Promo Code </h4>
                                <div class="row">
                                    <div class="col-lg-12 col-xs-12" >
                                        <span class="p-0 col-lg-6 col-xs-12 m-t-20" style="color: #ee7670">{{payment.promoResponse||"YAAAAYYYY"}}</span>
                                        <a class="m-t-20 col-xs-12 col-lg-6 pull-right p-0" style="text-decoration: underline" ng-click="payment.removePromo()">Remove Promo</a>
                                    </div>
                                </div>
                            </div>
                            <div class="p-15 w-100" style="display: table;">
                                <h4>Special Instructions</h4>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="form-group">
                                            <input class="form-control" ng-model="payment.specialInst">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-xs-12 col-md-4 col-sm-12 ">
                        <div class="whiteDiv col-lg-12 p-0">
                            <div class="whiteHeader p-15">
                                <h4>Booking Summary</h4>
                            </div>
                            <div class="p-15" style="display: table">
                                <h2><i class="fa fa-gbp"></i> {{payment.totalPrice}}</h2>
                                <h4>{{payment.service.service_name}} - {{payment.category.category_name}}</h4>
                                <label ng-if="payment.additionalServices.length>0" class="col-lg-12"
                                       ng-repeat="data in payment.additionalServices">- {{data.as_name}}</label>
                            </div>
                            <div class="greyFooter p-15">
                                <h4 class="m-t-0">{{payment.bookingTime|date:'EEEE'}}</h4>
                                <label>{{payment.bookingTime|date:'MMMM dd, yyyy | hh:mm a'}}</label>
                            </div>

                            <div class="whiteFooter p-15">
                                <h4 class="m-t-0">{{payment.address.address_title}}</h4>
                                <label>{{payment.address.apt_address}} {{payment.address.city}}</label>
                            </div>
                        </div>
                        <button class="btn btnDefault w-100 m-t-30" ng-click="payment.goToThanks()"  ng-disabled="mCtrl.hitInProgress">Next</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/ng-template" id="addCardModal">
        <div class="ngdialog-message logoutpopo">

            <div class="ngdialog-header">
                <p>Add New Card</p>
            </div>
            <div class="ngdialog-body">
                <form name="payment.addCardPop" ng-submit="payment.addCardPop.$submitted&&payment.addCardUser(1)">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="form-group">
                                <label>Credit/Debit Card Number</label>
                                <input masked="" data-inputmask="'mask': '9999 9999 9999 9999'" required
                                       onkeypress="return isNumberKey(event)" class="form-control" ng-model="payment.addCard.number">
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="form-group">
                                <label>Month</label>
                                <select ng-model="payment.addCard.month" class="form-control">
                                    <option value="">Month</option>
                                    <option ng-value="month" ng-repeat="month in months">{{month.month}} ({{month.month_name}})</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="form-group">
                                <label>Year</label>
                                <select ng-model="payment.addCard.year" class="form-control" >
                                    <option value="">Year</option>
                                    <option ng-value="year" ng-repeat="year in newYears">{{year}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="form-group">
                                <label>CVV</label>
                                <input type="password" required class="form-control" ng-model="payment.addCard.cvv" maxlength="4" minlength="3">
                            </div>
                        </div>
                    </div>
                    <hr class="popHR">
                    <button type="button" ng-click="closeThisDialog('button')"
                            class="btn btn-default pull-left btn-cancel">Cancel
                    </button>
                    <button type="submit" class="btn btn-primary pull-right btn-pop"  ng-disabled="mCtrl.hitInProgress">Add Card
                    </button>
                </form>


            </div>
        </div>
    </script>
</div>
